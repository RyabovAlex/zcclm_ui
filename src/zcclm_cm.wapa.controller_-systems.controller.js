sap.ui.define(["sap/ui/core/mvc/Controller"], function (Controller) {                                                                                                                                                                                          
	"use strict";                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
	return Controller.extend("sap.cust.zcclm_cm.controller.Systems", {                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
		onInit: function () {                                                                                                                                                                                                                                        
			this.systemsTable = this.getView().byId("idSystemsTable");                                                                                                                                                                                                  
			this.getOwnerComponent().getRouter().getRoute("Systems")                                                                                                                                                                                                    
				.attachPatternMatched(this.onRouteMatched, this);                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onRouteMatched: function (event) {                                                                                                                                                                                                                           
			this.landscapeId = event.getParameter("arguments").Id;                                                                                                                                                                                                      
			var filters = [];                                                                                                                                                                                                                                           
			filters.push(new sap.ui.model.Filter({                                                                                                                                                                                                                      
				path: "Landscapeid",                                                                                                                                                                                                                                       
				operator: sap.ui.model.FilterOperator.EQ,                                                                                                                                                                                                                  
				value1: this.landscapeId                                                                                                                                                                                                                                   
			}));                                                                                                                                                                                                                                                        
			var template = new sap.m.ColumnListItem({                                                                                                                                                                                                                   
				cells: [new sap.m.Text({                                                                                                                                                                                                                                   
					text: '{Systemid}'                                                                                                                                                                                                                                        
				}), new sap.ui.core.Icon({                                                                                                                                                                                                                                 
					src: {                                                                                                                                                                                                                                                    
						path: 'Jobstatus',                                                                                                                                                                                                                                       
						formatter: this.getIconType                                                                                                                                                                                                                              
					},                                                                                                                                                                                                                                                        
					color: {                                                                                                                                                                                                                                                  
						path: 'Jobstatus',                                                                                                                                                                                                                                       
						formatter: this.getIconColor                                                                                                                                                                                                                             
					},                                                                                                                                                                                                                                                        
					size: "2em"                                                                                                                                                                                                                                               
				}), new sap.ui.core.Icon({                                                                                                                                                                                                                                 
					src: {                                                                                                                                                                                                                                                    
						path: 'Extractorstatus',                                                                                                                                                                                                                                 
						formatter: this.getIconType                                                                                                                                                                                                                              
					},                                                                                                                                                                                                                                                        
					color: {                                                                                                                                                                                                                                                  
						path: 'Extractorstatus',                                                                                                                                                                                                                                 
						formatter: this.getIconColor                                                                                                                                                                                                                             
					},                                                                                                                                                                                                                                                        
					size: "2em"                                                                                                                                                                                                                                               
				}), new sap.ui.core.Icon({                                                                                                                                                                                                                                 
					src: {                                                                                                                                                                                                                                                    
						path: 'Collectorstatus',                                                                                                                                                                                                                                 
						formatter: this.getIconType                                                                                                                                                                                                                              
					},                                                                                                                                                                                                                                                        
					color: {                                                                                                                                                                                                                                                  
						path: 'Collectorstatus',                                                                                                                                                                                                                                 
						formatter: this.getIconColor                                                                                                                                                                                                                             
					},                                                                                                                                                                                                                                                        
					size: "2em"                                                                                                                                                                                                                                               
				}), new sap.ui.core.Icon({                                                                                                                                                                                                                                 
					src: {                                                                                                                                                                                                                                                    
						path: 'Notestatus',                                                                                                                                                                                                                                      
						formatter: this.getIconType                                                                                                                                                                                                                              
					},                                                                                                                                                                                                                                                        
					color: {                                                                                                                                                                                                                                                  
						path: 'Notestatus',                                                                                                                                                                                                                                      
						formatter: this.getIconColor                                                                                                                                                                                                                             
					},                                                                                                                                                                                                                                                        
					size: "2em"                                                                                                                                                                                                                                               
				})],                                                                                                                                                                                                                                                       
				vAlign: 'Middle',                                                                                                                                                                                                                                          
				type: 'Navigation'                                                                                                                                                                                                                                         
			});                                                                                                                                                                                                                                                         
			var bindingInfo = {                                                                                                                                                                                                                                         
				path: "/SYSTEM_STATUSSet",                                                                                                                                                                                                                                 
				filters: filters,                                                                                                                                                                                                                                          
				template: template                                                                                                                                                                                                                                         
			};                                                                                                                                                                                                                                                          
			this.systemsTable.bindItems(bindingInfo);                                                                                                                                                                                                                   
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onSystemSelection: function (event) {                                                                                                                                                                                                                        
			var context = event.getSource().getSelectedItem()                                                                                                                                                                                                           
				.getBindingContext();                                                                                                                                                                                                                                      
			var systemId = context.getProperty("Systemid");                                                                                                                                                                                                             
			if (systemId) {                                                                                                                                                                                                                                             
				this.getOwnerComponent().getRouter().navTo("SystemPage", {                                                                                                                                                                                                 
					Id: this.landscapeId + "-" + systemId                                                                                                                                                                                                                     
				});                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getIconType: function (level) {                                                                                                                                                                                                                              
			switch (level) {                                                                                                                                                                                                                                            
			case 0:                                                                                                                                                                                                                                                     
				return "sap-icon://message-success";                                                                                                                                                                                                                       
			case 1:                                                                                                                                                                                                                                                     
				return "sap-icon://message-warning";                                                                                                                                                                                                                       
			case 2:                                                                                                                                                                                                                                                     
				return "sap-icon://message-error";                                                                                                                                                                                                                         
			default:                                                                                                                                                                                                                                                    
				return "sap-icon://sys-help";                                                                                                                                                                                                                              
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		getIconColor: function (level) {                                                                                                                                                                                                                             
			switch (level) {                                                                                                                                                                                                                                            
			case 0:                                                                                                                                                                                                                                                     
				return "#2b7d2b";                                                                                                                                                                                                                                          
			case 1:                                                                                                                                                                                                                                                     
				return "#e78c07";                                                                                                                                                                                                                                          
			case 2:                                                                                                                                                                                                                                                     
				return "#bb0000";                                                                                                                                                                                                                                          
			default:                                                                                                                                                                                                                                                    
				return "#000000";                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onBack: function () {                                                                                                                                                                                                                                        
			history.go(-1);                                                                                                                                                                                                                                             
		},                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
		onUpdPress: function (event) {                                                                                                                                                                                                                               
			this.getView().getModel().callFunction("/MASS_UPDATE", "POST", // http method                                                                                                                                                                               
				{}, // function import parameters                                                                                                                                                                                                                          
				null,                                                                                                                                                                                                                                                      
				function (oData, response) {                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
				}, // callback function for success                                                                                                                                                                                                                        
				function (oError) {});                                                                                                                                                                                                                                     
			sap.m.MessageToast.show("Background job 'ZCCLM_STATUS_UPDATE' was scheduled. Landscapes status will be updated");                                                                                                                                           
		}                                                                                                                                                                                                                                                            
	});                                                                                                                                                                                                                                                           
});                                                                                                                                                                                                                                                            